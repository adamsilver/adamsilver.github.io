<!DOCTYPE HTML>
<html dir="ltr" lang="en">
	<head>
	    
	
		<title>Don't use AJAX for personalised content by Adam Silver</title>
	


<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="initial-scale=1.0">
<meta name="Author" content="Adam Silver">

<link rel="apple-touch-icon" sizes="57x57" href="//localhost:4000/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="//localhost:4000/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="//localhost:4000/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="//localhost:4000/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="//localhost:4000/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="//localhost:4000/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="//localhost:4000/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="//localhost:4000/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="//localhost:4000/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="//localhost:4000/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="//localhost:4000/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="//localhost:4000/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="//localhost:4000/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="//localhost:4000/manifest.json">
<link rel="mask-icon" href="//localhost:4000/safari-pinned-tab.svg" color="#001f3f">
<meta name="msapplication-TileColor" content="#001F3F">
<meta name="msapplication-TileImage" content="//localhost:4000/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">

<meta property="og:locale" content="en_GB">
<meta property="og:type" content="website">


	
		<meta content="Don't use AJAX for personalised content by Adam Silver" property="og:title">
	



	<meta property="og:description" content="Sometimes developers are on a pursuit to reduce page-load time by utilising AJAX to get around personalised content. This is problematic.">


<meta property="og:url" content="//localhost:4000/articles/dont-use-ajax-for-personalised-content/">
<meta property="og:site_name" content="Adamsilver.io">
<meta property="og:image" content="//localhost:4000/assets/img/card.png">
<meta property="og:image:width" content="181">
<meta property="og:image:height" content="181">

<meta name="twitter:card" content="summary">


	<meta name="twitter:description" content="Sometimes developers are on a pursuit to reduce page-load time by utilising AJAX to get around personalised content. This is problematic.">


<meta name="twitter:title" content="Don't use AJAX for personalised content -  Adam Silver: interaction designer and interface developer from London, UK">


	<meta content="Don't use AJAX for personalised content" name="twitter:title">


<meta name="twitter:site" content="@adambsilver">
<meta name="twitter:creator" content="@adambsilver">
<meta property="twitter:image" content="//localhost:4000/assets/img/card.png">


	<meta itemprop="description" content="Sometimes developers are on a pursuit to reduce page-load time by utilising AJAX to get around personalised content. This is problematic.">


<!-- build:css /assets/css/main.min.css -->
<link rel="stylesheet" href="/assets/css/main.css" type="text/css" media="all">
<!-- endbuild -->

<!-- build:css /assets/css/ie8.min.css -->
<!--[if IE 8]>
<link rel="stylesheet" href="/assets/css/ie8.css" type="text/css" media="all">
<![endif]-->
<!-- endbuild -->

<!-- build:css /assets/css/ie7.min.css -->
<!--[if IE 7]>
<link rel="stylesheet" href="/assets/css/ie7.css" type="text/css" media="all">
<![endif]-->
<!-- endbuild -->


<!-- build:css /assets/css/ie6.min.css -->
<!--[if IE 6]>
<link rel="stylesheet" href="/assets/css/ie6.css" type="text/css" media="all">
<![endif]-->
<!-- endbuild -->


<link rel="canonical" href="//localhost:4000/articles/dont-use-ajax-for-personalised-content/">
<link rel="author" href="https://plus.google.com/u/0/+AdamSilver1">

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-47311666-1', 'auto');
  ga('send', 'pageview');

</script>

	</head>
	<body>
	  <!-- <header role="banner">
	<a href="/"><img src="/assets/img/logo2.png" alt="Home" width="100"></a>
</header> -->
	<nav class="nav">
	<ul>
		<li><a class="" href="/">Home</a></li>
		<li><a class="nav-active" href="/articles/">Articles</a></li>
		<li><a class="" href="/about/">About</a></li>
		<li><a class="" href="/signup/">Newsletter</a></li>
	</ul>
</nav>
	  <main class="mainContent">
			<h1 class="article-heading">Don't use AJAX for personalised content</h1>
			<!-- <div class="meta">
	<time class="meta-date" date-time="2014-12-29">29 December 2014</time> <span class="meta-divider">&#183;</span>
	<span class="meta-readingTime" title="Estimated read time">
	  

	  
	    3 minute read
	  
	</span>
</div> -->
	      <p><a href="https://developer.akamai.com/stuff/Caching/Content_Caching.html">Content caching</a> is a useful technique to increase the loading speed of a page. If the page has personalised content this technique doesn’t work. This is is because one user may receive another user’s personalised content which is insecure and undesirable.</p>

<p>The problem comes when someone suggests using AJAX to request the personalised content as a separate request. Before discussing the problem let’s define exactly what personalised content is.</p>

<h2 id="what-is-personalised-content">What is personalised content?</h2>

<p>Personalised content is content that is specific to a user. The most basic example would be a “Logout” link. This is because the page knows that <em>you</em> are logged in and that <em>you</em> may want to logout.</p>

<p>Even though this is personal it’s cacheable because we can have two groups of users: logged out and logged in users. In which case, we can serve the correct cached page to each group with a cookie check.</p>

<p>Specific information, such as a user’s name, or the contents of their shopping basket can’t be cached.</p>

<p>Now that’s clear, we can discuss the issues with using AJAX to request personalised content:</p>

<h2 id="the-architecture-becomes-complex">1. The architecture becomes complex</h2>

<p>Using AJAX has a significant impact on architecture.</p>

<ul>
  <li>Is there one extra request for personalised content or multiple?</li>
  <li>Do we serve it as JSON and then parse that on the client?</li>
  <li>How do we organise and initialise scripts?</li>
  <li>How do we organise partials?</li>
  <li>At what point is personalised content not essential to the experience?</li>
</ul>

<h2 id="some-people-will-have-a-broken-experience">2. Some people will have a broken experience</h2>

<p>If the user doesn’t have Javascript (and there are <a href="http://kryogenix.org/code/browser/everyonehasjs.html">many reasons why they won’t</a>), they’ll get an incomplete or broken page. Not being able to logout, or not being able to see their basket is an example.</p>

<p>This goes against Progressive Enhancement which in-turn goes against the spirit of the web. We shouldn’t unnecessarily exclude people.</p>

<h2 id="replacing-browser-behaviour-degrades-the-experience">3. Replacing browser behaviour degrades the experience</h2>

<p>Using AJAX to load content stops us using the inherent functionality browsers provide for free. This functionality is an intuitive aspect of the browsing experience.</p>

<p>This includes displaying a loading indicator that accurately indicates the progress of the request. It also includes handling response and timeout errors.</p>

<p>Using AJAX and content-caching like this, means at first the page is only half rendered. Then, sometime later, the personalised content is injected into the page. This is, at least a little jarring as the page fills in the gaps.</p>

<p>We’ll need to implement loading spinners, and hide content, and show the content perhaps with a transition. These things are often janky and they differ from site to site making for a low quality experience.</p>

<p>Moreover, the request may finish after scrolling down the page. This means the user may not notice this new personalised content and the page may jump unexpectedly.</p>

<h2 id="extra-work-is-needed">4. Extra work is needed</h2>

<p>First, a designer needs to design a loading spinner and transitions. Second, developers need to implement this functionality in good order for browsers and assistive technology. Third, testers will need to test and AJAX makes functional tests harder to write.</p>

<h2 id="performance-actually-degrades">5. Performance actually degrades</h2>

<p>Instead of a single HTTP request containing the whole response, there will now be multiple. The first would be for the Document containing non-personalised content. The next request(s) will be via AJAX and <em>will</em> hit the web server, therefore subject to the same latency as always.</p>

<p>And any performance increase is negated by the extra JS and CSS which needs to download and execute, including reflows and repaints in the browser. This includes:</p>

<ul>
  <li>making a JSON request;</li>
  <li>parsing the response;</li>
  <li>handling errors;</li>
  <li>finding elements;</li>
  <li>traversing the Document tree;</li>
  <li>updating the Document; and</li>
  <li>loading spinners and whatever else.</li>
</ul>

<h2 id="summary">Summary</h2>

<p>Content-caching <em>is</em> a very useful technique when used responsibly and for pages that don’t contain personalised content. For pages that <em>do</em> contain personalised content, a <a href="https://blogs.akamai.com/2014/05/and-you-thought-your-page-could-not-be-cached.html">cookie check can determine whether the cached version should be served or not</a>.</p>

<p>Enhancements should not break the web, and make the experience worse. It should enhance the experience where it is valuable to do so.</p>

<p>AJAX seems like an innocent and beneficial solution, but it encourages bad practice that creates several self-induced problems for users and the development team.</p>

<!--

## Todo:

* https://remysharp.com/2012/04/25/mobile-battery-performance
* http://itamarst.org/writings/dynamiccaching.html
* cache invalidated means it goes to server anyway

## Comment from blog covers it off:

> I think this would be a useful technique in only special situations. It does accomplish what you want but will require multiple downloads and will make a portion of your page unaccessible to those who have disabled JS (from what I have heard that is 10% of the intenet population).

> Plus I am dubious of the savings. The reason for the caching to not have a web brower contact the website. It can just retrieve the content from cache. But if it is having to retrieve a portion of the content anyway you still have to make a HTTP request. Might as well make that response a bit bigger and get rid of the multiple requests and more complex code.

> Sounds to me like this is going a little overboard on caching. Some pages are just not designed for caching. If that is the case then implement your application to use the “If-Modified-Since” header. That way the user can make their request but get back a small response in most cases.

> I think this is premature optimization.

-->

	  </main>
		<div class="signUpHero">
	<p class="signUpHero-description">I write articles like this and share them with my private mailing list. No spam and definitely no popups. Just one article a month, straight to your inbox. Sign up below:</p>
</div>

<div class="testForm">
	<form action="//adamsilver.us9.list-manage.com/subscribe/post?u=b8fb04f39bf86109693e00ba5&amp;id=441c045a36" method="post">
		<input type="hidden" name="b_b8fb04f39bf86109693e00ba5_441c045a36" value="">
		<input type="hidden" name="SITE" value="//localhost:4000">
		<input type="hidden" name="LOCATION" value="/articles/dont-use-ajax-for-personalised-content/">
		<label for="mce-EMAIL" class="testForm-label">Your email address</label>
		<input type="email" name="EMAIL" id="mce-EMAIL" class="testForm-email" required><input class="testForm-button" type="submit" value="Join 1,000+ others" name="subscribe">
	</form>
</div>
	</body>
</html>